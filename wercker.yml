installOSB:
  box:
      id: openjdk:10
      ports:
        - 8080
        
  steps:
  - bash-template
  
  - script:
      name: "Check linux version"
      code: cat /etc/os-release
  
  - script:
      name: "Visualise directory"
      code: ls -al
      
  - script:
       name: helm install
       code: |
         mkdir -p helm
         curl https://storage.googleapis.com/kubernetes-helm/helm-v2.10.0-linux-amd64.tar.gz  | tar zxv -C helm
         mv helm/linux-amd64/helm /usr/local/bin/helm
         helm version --client
         helm init --client-only
      
  - script:
      name: "Add the Kubernetes Service Catalog helm repository"
      code: helm repo add svc-cat https://svc-catalog-charts.storage.googleapis.com
      
  - script:
      name: "Install the Kubernetes Service Catalog helm chart"
      code: |
        cat $CONFIG > ~/.kube/config
        cat ~/.kube/config
        helm install svc-cat/catalog --namespace stm --timeout 300 --name catalog
      
  - script:
      name: "Install svcat tool"
      code: |
        curl -sLO https://download.svcat.sh/cli/latest/linux/amd64/svcat
        chmod +x ./svcat
        mv ./svcat /usr/local/bin/
        svcat version --client
        
